{% extends 'base.html' %}
{% block title %}Imprimir Atestado{% endblock %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3 no-print">
    <h3 class="mb-0">Atestado Médico</h3>
    <div class="d-flex gap-2">
      <a href="{% url 'rh-atestado-list' %}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
      </a>
      <button type="button" class="btn btn-primary" onclick="window.print()">
        <i class="bi bi-printer"></i> Imprimir
      </button>
    </div>
  </div>
  <div class="card shadow-sm">
    <div class="card-body">
      <div class="text-center mb-4">
        <h4 class="fw-bold">Atestado Médico</h4>
        <p class="text-muted mb-0">Emitido para fins de controle interno da Secretaria Municipal de Saúde</p>
      </div>
      <div class="row g-3 mb-4">
        <div class="col-md-6">
          <span class="text-uppercase small text-muted">Funcionário</span>
          <p class="fs-5 fw-semibold mb-0">{{ obj.funcionario.nome }}</p>
        </div>
        <div class="col-md-3">
          <span class="text-uppercase small text-muted">CPF</span>
          <p class="mb-0">{{ obj.funcionario.cpf }}</p>
        </div>
        <div class="col-md-3">
          <span class="text-uppercase small text-muted">Cargo</span>
          <p class="mb-0">{{ obj.funcionario.cargo }}</p>
        </div>
        <div class="col-md-6">
          <span class="text-uppercase small text-muted">Setor/Lotação</span>
          <p class="mb-0">{{ obj.funcionario.setor_lotacao|default:'—' }}</p>
        </div>
        <div class="col-md-3">
          <span class="text-uppercase small text-muted">Situação</span>
          <p class="mb-0">{{ obj.funcionario.get_situacao_display }}</p>
        </div>
        <div class="col-md-3">
          <span class="text-uppercase small text-muted">Vínculo</span>
          <p class="mb-0">{{ obj.funcionario.get_vinculo_display }}</p>
        </div>
      </div>
      <hr>
      <div class="row g-3 mb-4">
        <div class="col-md-4">
          <span class="text-uppercase small text-muted">Data inicial</span>
          <p class="mb-0 fw-semibold">{{ obj.data_inicio|date:'d/m/Y' }}</p>
        </div>
        <div class="col-md-4">
          <span class="text-uppercase small text-muted">Data final</span>
          <p class="mb-0 fw-semibold">{{ obj.data_fim|date:'d/m/Y' }}</p>
        </div>
        <div class="col-md-4">
          <span class="text-uppercase small text-muted">Dias de afastamento</span>
          <p class="mb-0 fw-semibold">{{ obj.dias }}</p>
        </div>
        <div class="col-md-4">
          <span class="text-uppercase small text-muted">CID</span>
          <p class="mb-0">{{ obj.cid|default:'—' }}</p>
        </div>
        <div class="col-md-4">
          <span class="text-uppercase small text-muted">Médico</span>
          <p class="mb-0">{{ obj.medico|default:'—' }}</p>
        </div>
        <div class="col-md-4">
          <span class="text-uppercase small text-muted">CRM</span>
          <p class="mb-0">{{ obj.crm|default:'—' }}</p>
        </div>
      </div>
      {% if obj.motivo %}
      <div class="mb-4">
        <span class="text-uppercase small text-muted">Motivo/Observações</span>
        <p class="mb-0">{{ obj.motivo|linebreaksbr }}</p>
      </div>
      {% endif %}
      {% if obj.arquivo %}
      <div class="mb-4">
        <span class="text-uppercase small text-muted">Anexo</span>
        <p class="mb-0">Arquivo vinculado: <a href="{{ obj.arquivo.url }}" target="_blank">Baixar</a></p>
      </div>
      {% endif %}
      <div class="row mt-5">
        <div class="col-md-6 text-center">
          <p class="mb-5">______________________________________________</p>
          <p class="fw-semibold">{{ obj.medico|default:'Médico responsável' }}</p>
          {% if obj.crm %}<p class="text-muted mb-0">CRM {{ obj.crm }}</p>{% endif %}
        </div>
        <div class="col-md-6 text-center">
          <p class="mb-5">______________________________________________</p>
          <p class="fw-semibold">{{ obj.funcionario.nome }}</p>
          <p class="text-muted mb-0">CPF {{ obj.funcionario.cpf }}</p>
        </div>
      </div>
  {% now 'd/m/Y H:i' as printed_at %}
  <p class="text-muted small mt-4">Impresso em {{ printed_at }}.</p>
    </div>
  </div>
</div>
{% endblock %}
